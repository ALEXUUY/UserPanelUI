<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ایجاد سایت - پنل مدیریت کسب‌وکار</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <!-- Desktop Sidebar -->
        <nav class="sidebar d-none d-md-block">
            <div class="sidebar-header">
                <h4><i class="fas fa-rocket me-2"></i>پنل کسب‌وکار</h4>
            </div>
            <ul class="sidebar-menu">
                <li><a href="dashboard.html"><i class="fas fa-home"></i>داشبورد</a></li>
                <li><a href="website-creation.html" class="active"><i class="fas fa-globe"></i>ایجاد سایت</a></li>
                <li><a href="advertising.html"><i class="fas fa-dollar-sign"></i>تبلیغات</a></li>
                <li><a href="marketing.html"><i class="fas fa-chart-line"></i>بازاریابی</a></li>
                <li><a href="affiliate.html"><i class="fas fa-users"></i>زیرمجموعه‌گیری</a></li>
                <li><a href="publishing.html"><i class="fas fa-book"></i>انتشار کتاب</a></li>
                <li><a href="profile.html"><i class="fas fa-user"></i>پروفایل</a></li>
                <li><a href="support.html"><i class="fas fa-headset"></i>پشتیبانی</a></li>
                <li><a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i>خروج</a></li>
            </ul>
        </nav>

        <!-- Mobile Bottom Navigation -->
        <nav class="mobile-nav d-md-none">
            <a href="dashboard.html" class="nav-item">
                <i class="fas fa-home"></i>
                <span>خانه</span>
            </a>
            <a href="website-creation.html" class="nav-item active">
                <i class="fas fa-globe"></i>
                <span>سایت</span>
            </a>
            <a href="marketing.html" class="nav-item">
                <i class="fas fa-chart-line"></i>
                <span>بازاریابی</span>
            </a>
            <a href="profile.html" class="nav-item">
                <i class="fas fa-user"></i>
                <span>پروفایل</span>
            </a>
            <a href="#" class="nav-item" onclick="showMobileMenu()">
                <i class="fas fa-bars"></i>
                <span>منو</span>
            </a>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header mb-4">
                <h2><i class="fas fa-globe me-2"></i>ایجاد سایت</h2>
                <p class="text-muted">سایت حرفه‌ای خود را طراحی و راه‌اندازی کنید</p>
            </header>

            <!-- Website Type Selection -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5>انتخاب نوع سایت</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6 col-lg-3">
                            <div class="website-type-card" onclick="selectWebsiteType('shop')">
                                <i class="fas fa-store"></i>
                                <h6>فروشگاهی</h6>
                                <p class="price">۴۷۰ هزار تومان</p>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <div class="website-type-card" onclick="selectWebsiteType('service')">
                                <i class="fas fa-tools"></i>
                                <h6>خدماتی</h6>
                                <p class="price">۴۷۰ هزار تومان</p>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <div class="website-type-card" onclick="selectWebsiteType('corporate')">
                                <i class="fas fa-building"></i>
                                <h6>شرکتی</h6>
                                <p class="price">۴۷۰ هزار تومان</p>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <div class="website-type-card" onclick="selectWebsiteType('personal')">
                                <i class="fas fa-user"></i>
                                <h6>شخصی</h6>
                                <p class="price">۴۷۰ هزار تومان</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Website Creation Form -->
            <div class="card">
                <div class="card-header">
                    <h5>فرم ایجاد سایت</h5>
                </div>
                <div class="card-body">
                    <form id="websiteForm">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">نام سایت</label>
                                <input type="text" class="form-control" id="siteName" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">نوع سایت انتخاب شده</label>
                                <input type="text" class="form-control" id="selectedType" readonly>
                            </div>
                            <div class="col-12">
                                <label class="form-label">توضیح کوتاه درباره محصول/خدمات</label>
                                <textarea class="form-control" id="siteDescription" rows="3" required></textarea>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">انتخاب قالب</label>
                                <select class="form-select" id="templateSelect" required>
                                    <option value="">انتخاب کنید</option>
                                    <option value="modern">مدرن</option>
                                    <option value="classic">کلاسیک</option>
                                    <option value="minimal">مینیمال</option>
                                    <option value="creative">خلاقانه</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">رنگ اصلی سایت</label>
                                <input type="color" class="form-control form-control-color" id="primaryColor" value="#007bff">
                            </div>
                            <div class="col-12">
                                <label class="form-label">آپلود لوگو</label>
                                <input type="file" class="form-control" id="logoUpload" accept="image/*">
                                <small class="form-text text-muted">فرمت‌های مجاز: JPG, PNG, SVG (حداکثر 2MB)</small>
                            </div>
                            <div class="col-12">
                                <label class="form-label">تصاویر اضافی</label>
                                <input type="file" class="form-control" id="imagesUpload" accept="image/*" multiple>
                                <small class="form-text text-muted">می‌توانید چندین تصویر انتخاب کنید</small>
                            </div>
                        </div>

                        <hr class="my-4">

                        <!-- Payment Section -->
                        <div class="payment-section">
                            <h6 class="mb-3">روش پرداخت</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <button type="button" class="btn btn-primary w-100" onclick="payOnline()">
                                        <i class="fas fa-credit-card me-2"></i>پرداخت آنلاین
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <button type="button" class="btn btn-outline-primary w-100" onclick="showBankInfo()">
                                        <i class="fas fa-university me-2"></i>کارت به کارت
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4">
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-paper-plane me-2"></i>ثبت درخواست
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- My Websites -->
            <div class="card mt-4">
                <div class="card-header">
                    <h5>سایت‌های من</h5>
                </div>
                <div class="card-body">
                    <div id="myWebsites">
                        <!-- Website list will be loaded here -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Bank Info Modal -->
    <div class="modal fade" id="bankInfoModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">اطلاعات پرداخت کارت به کارت</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <div class="bank-info">
                        <i class="fas fa-university mb-3" style="font-size: 3rem; color: #007bff;"></i>
                        <h6>شماره کارت:</h6>
                        <p class="bank-card-number">1234-5678-9012-3456</p>
                        <h6>نام صاحب حساب:</h6>
                        <p>شرکت فناوری کسب‌وکار</p>
                        <h6>مبلغ قابل پرداخت:</h6>
                        <p class="text-success fs-5">۴۷۰,۰۰۰ تومان</p>
                        <div class="alert alert-info">
                            <small>بعد از واریز، فیش پرداخت را از طریق تیکت پشتیبانی ارسال کنید</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
    <script>
        // Check authentication
        if (!Auth.isLoggedIn()) {
            window.location.href = 'login.html';
        }

        let selectedWebsiteType = '';

        function selectWebsiteType(type) {
            selectedWebsiteType = type;
            document.getElementById('selectedType').value = getTypeLabel(type);
            
            // Update visual selection
            document.querySelectorAll('.website-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function getTypeLabel(type) {
            const labels = {
                'shop': 'فروشگاهی',
                'service': 'خدماتی',
                'corporate': 'شرکتی',
                'personal': 'شخصی'
            };
            return labels[type] || '';
        }

        function payOnline() {
            alert('در حال انتقال به درگاه پرداخت...');
            // Simulate online payment
            setTimeout(() => {
                alert('پرداخت با موفقیت انجام شد');
            }, 2000);
        }

        function showBankInfo() {
            new bootstrap.Modal(document.getElementById('bankInfoModal')).show();
        }

        document.getElementById('websiteForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!selectedWebsiteType) {
                alert('لطفاً نوع سایت را انتخاب کنید');
                return;
            }

            const formData = {
                type: selectedWebsiteType,
                name: document.getElementById('siteName').value,
                description: document.getElementById('siteDescription').value,
                template: document.getElementById('templateSelect').value,
                primaryColor: document.getElementById('primaryColor').value,
                createdAt: new Date().toLocaleDateString('fa-IR'),
                status: 'در انتظار تأیید'
            };

            // Save to storage
            let websites = Storage.get('userWebsites') || [];
            websites.push(formData);
            Storage.set('userWebsites', websites);

            // Add to recent activity
            App.addActivity('fas fa-globe', `درخواست ایجاد سایت "${formData.name}" ثبت شد`);

            alert('درخواست شما با موفقیت ثبت شد');
            loadMyWebsites();
            this.reset();
            selectedWebsiteType = '';
            document.getElementById('selectedType').value = '';
        });

        function loadMyWebsites() {
            const websites = Storage.get('userWebsites') || [];
            const container = document.getElementById('myWebsites');

            if (websites.length === 0) {
                container.innerHTML = '<p class="text-muted text-center">هنوز هیچ سایتی ثبت نکرده‌اید</p>';
                return;
            }

            container.innerHTML = websites.map(site => `
                <div class="website-item">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h6>${site.name}</h6>
                            <p class="text-muted mb-1">${site.description}</p>
                            <small class="text-muted">تاریخ ثبت: ${site.createdAt}</small>
                        </div>
                        <div class="text-end">
                            <span class="badge bg-warning">${site.status}</span>
                            <div class="mt-2">
                                <small class="text-muted">${getTypeLabel(site.type)}</small>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Load existing websites on page load
        document.addEventListener('DOMContentLoaded', loadMyWebsites);

        function logout() {
            Auth.logout();
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
